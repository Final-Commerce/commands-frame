# getProductVariants

Retrieves all variants for a specific product from the parent application's local database.

## Parameters

### `GetProductVariantsParams`

```typescript
interface GetProductVariantsParams {
    productId: string;
}
```

#### `productId` (required)

The ID of the product to get variants for.

## Response

### `GetProductVariantsResponse`

```typescript
interface GetProductVariantsResponse {
    variants: any[];
    productId: string;
    timestamp: string;
}
```

#### `variants` (any[])

Array of variant objects for the specified product. A typical variant object may contain the following fields:

```typescript
// Reference structure (actual structure may vary)
interface Variant {
    _id?: string;                     // Variant ID
    id?: string;                      // Alternative ID field
    companyId?: string;               // Company identifier
    productId: string;                // Parent product ID
    allowBackorder?: boolean;         // Allow backorder flag
    attributes?: Array<{ name?: string; value?: string }>;  // Variant attributes
    barcode?: string;                 // Barcode
    externalId?: string;              // External system ID
    images: string[];                 // Variant images
    inventory?: Array<{ stock?: number; outletId?: string }>;   // Inventory per outlet
    manageStock?: boolean;           // Stock management flag
    isOnSale?: boolean;              // Sale status
    metadata?: Array<{ key?: string; value?: string }>;    // Custom metadata
    price?: string;                  // Regular price
    salePrice?: string;              // Sale price
    sku?: string;                    // Variant SKU
    costPrice?: string;              // Cost price
    name?: string;                   // Variant name
    isDeleted?: boolean;             // Deletion flag
    createdAt?: Date | string;      // Creation timestamp
    updatedAt?: Date | string;       // Last update timestamp
}
```

#### `productId` (string)

The product ID that was queried.

#### `timestamp` (string)

ISO 8601 timestamp string (e.g., `"2024-01-01T00:00:00.000Z"`) indicating when the response was generated by the handler.

## Usage

```typescript
import { commands } from '@final-commerce/commands-frame';
```

## Usage Examples

### Get Variants for a Product

```typescript
import { commands } from '@final-commerce/commands-frame';

const result = await commands.getProductVariants({
    productId: 'product-id-123'
});

console.log(result.variants);
```

### Handle Empty Variants

```typescript
const result = await commands.getProductVariants({
    productId: 'product-id-123'
});

if (result.variants.length === 0) {
    console.log('This product has no variants');
} else {
    console.log(`Found ${result.variants.length} variants`);
}
```

### Access Variant Properties

```typescript
const result = await commands.getProductVariants({
    productId: 'product-id-123'
});

result.variants.forEach(variant => {
    console.log(`Variant: ${variant.name || variant.sku}`);
    console.log(`Price: ${variant.price}`);
    console.log(`Stock: ${variant.inventory?.[0]?.stock || 0}`);
});
```

## Variant Structure Reference

The variant structure may vary depending on the database implementation. The structure shown above is a reference based on MongoDB schemas. In practice, variant objects are returned as `any` to allow flexibility between different database implementations (MongoDB/mongoose vs LokiJS/IndexedDB).

Key fields that may be present:

- **Attributes**: Variant attributes with name and value pairs (e.g., Size: "Large", Color: "Red").
- **Inventory**: Variant inventory is tracked per outlet in the `inventory` array.
- **Pricing**: Variants can have `price`, `salePrice`, and `costPrice`.
- **ID fields**: The ID field structure depends on the database (may be `id`, `_id`, or other formats).

## Error Handling

If the product ID is not provided, the handler will throw an error:

```typescript
try {
    const result = await commands.getProductVariants({
        productId: 'product-id-123'
    });
} catch (error) {
    console.error('Error:', error.message); // "Product ID is required"
}
```

If the query fails or no variants are found, the handler returns an empty array:

```typescript
{
    variants: [],
    productId: "product-id-123",
    timestamp: "2024-01-01T00:00:00.000Z"
}
```

## Notes

- Deleted variants (`isDeleted: true`) are automatically excluded
- Variants are sorted by name (ascending) by default
- The function requires a valid product ID
- If the product doesn't exist or has no variants, an empty array is returned

