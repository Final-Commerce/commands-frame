# getProducts

Retrieves a list of products from the parent application's local database.

## Parameters

### `GetProductsParams`

```typescript
interface GetProductsParams {
    query?: {
        name?: string | { $regex?: string; $options?: string };
        sku?: string | { $regex?: string; $options?: string };
        status?: string;
        productType?: string;
        categories?: string | { $in?: string[] };
        tags?: string | { $in?: string[] };
        supplier?: string;
        externalId?: string;
        [key: string]: any;
    };
}
```

#### `query` (optional)

A query object to filter products. The actual supported query operators depend on the database implementation (MongoDB/mongoose vs LokiJS/IndexedDB).

**Note:** The handler automatically excludes deleted products and limits results to 100 items by default.

## Response

### `GetProductsResponse`

```typescript
interface GetProductsResponse {
    products: any[];
    timestamp: string;
}
```

#### `products` (any[])

Array of product objects matching the query. The actual structure may vary depending on the database implementation (MongoDB/mongoose vs LokiJS/IndexedDB). See the [Real Data Examples](#real-data-examples) section below for actual product and variant object structures.

#### `timestamp` (string)

ISO 8601 timestamp string (e.g., `"2024-01-01T00:00:00.000Z"`) indicating when the response was generated by the handler.

## Usage

```typescript
import { commands } from '@final-commerce/commands-frame';
```

## Usage Examples

### Basic Query

Get all products (up to 100):

```typescript
import { commands } from '@final-commerce/commands-frame';

const result = await commands.getProducts();
console.log(result.products);
```

## Real Data Examples

### Example Response

```json
{
  "products": [
    {
      "_id": "691df9c6c478bada1fb23d31",
      "name": "Final Coffee ",
      "productType": "variable",
      "source": "standalone",
      "companyId": "691df9c4c478bada1fb23bff",
      "minPrice": "10.00",
      "maxPrice": "10.00",
      "isDeleted": false,
      "createdAt": "2024-12-03T10:00:00.000Z",
      "updatedAt": "2024-12-03T10:00:00.000Z"
    },
    {
      "_id": "691df9c6c478bada1fb23d32",
      "name": "Cool Shirt",
      "productType": "variable",
      "source": "standalone",
      "companyId": "691df9c4c478bada1fb23bff",
      "minPrice": "20.00",
      "maxPrice": "20.00",
      "isDeleted": false,
      "createdAt": "2024-12-03T10:00:00.000Z",
      "updatedAt": "2024-12-03T10:00:00.000Z"
    },
    {
      "_id": "691df9c6c478bada1fb23d33",
      "name": "Final Juice",
      "productType": "variable",
      "source": "standalone",
      "companyId": "691df9c4c478bada1fb23bff",
      "minPrice": "23.00",
      "maxPrice": "42.00",
      "isDeleted": false,
      "createdAt": "2024-12-03T10:00:00.000Z",
      "updatedAt": "2024-12-03T10:00:00.000Z"
    }
  ],
  "timestamp": "2025-12-04T19:23:45.123Z"
}
```

### Example Product with Variants

```json
{
  "_id": "691df9c6c478bada1fb23d31",
  "name": "Final Coffee ",
  "productType": "variable",
  "source": "standalone",
  "companyId": "691df9c4c478bada1fb23bff",
  "minPrice": "10.00",
  "maxPrice": "10.00",
  "images": [
    "https://storage.googleapis.com/attachments-dev-1/67e3f8092d38e6eb3c4cbbc6/1759858638421_CoffeSwagShop-600x600.png"
  ],
  "variants": [
    {
      "_id": "691df9c6c478bada1fb23d55",
      "productId": "691df9c6c478bada1fb23d31",
      "price": "10.00",
      "images": [
        "https://storage.googleapis.com/attachments-dev-1/67e3f8092d38e6eb3c4cbbc6/1759858638421_CoffeSwagShop-600x600.png"
      ],
      "isDeleted": false,
      "createdAt": "2024-12-03T10:00:00.000Z",
      "updatedAt": "2024-12-03T10:00:00.000Z"
    }
  ],
  "isDeleted": false,
  "createdAt": "2024-12-03T10:00:00.000Z",
  "updatedAt": "2024-12-03T10:00:00.000Z"
}
```

## Product Structure Reference

The product structure may vary depending on the database implementation. The structure shown above is a reference based on MongoDB schemas. In practice, product objects are returned as `any` to allow flexibility between different database implementations (MongoDB/mongoose vs LokiJS/IndexedDB).

Key fields that may be present:

- **Attributes**: Product attributes with name and values array.
- **Metadata**: Array of key-value pairs for custom data.
- **Variants**: Product variants with their own pricing, inventory, and attributes.
- **Inventory**: Variant inventory is tracked per outlet in the `inventory` array.
- **ID fields**: The ID field structure depends on the database (may be `id`, `_id`, or other formats).

## Error Handling

If the query fails or no products are found, the handler returns an empty array:

```typescript
{
    products: [],
    timestamp: "2024-01-01T00:00:00.000Z"
}
```

## Notes

- Results are limited to 100 products per request
- Deleted products (`isDeleted: true`) are automatically excluded
- Variants may be included in the response depending on the handler implementation

